<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<style>
body
{
	color: #F8F;
	background: url("pob.jpg") repeat;
	font-family: "Comic Neue", "Comic Sans MS", "Helvetica", Sans-Serif;
	overflow: hidden;
}

div#container
{
	position: absolute;
	top: 0;
	left: 0;
	height: 100vh;
	width: 100vw;
	background: rgba(0, 0, 0, 0.8);
	-webkit-transition:	background-color 2s linear;
	-moz-transition:	background-color 2s linear;
	-o-transition:		background-color 2s linear;
	transition:			background-color 2s linear;
}

div.change#container
{
	background: rgba(0, 0, 0, 0.9);
}

h1
{
	text-align: center;
}

canvas
{
	border: #222 2px solid;
}

canvas#bullet_canvas
{
	position: absolute;
	left: 1em;
}

canvas#info_canvas
{
	position: absolute;
	left: 21em;
	margin-top: 250px;
}

img
{
	position: absolute;
	left: 21em;
	margin-top: 1em;
}

span#song
{
	/*
	position: absolute;
	bottom: 0.25em;
	right: 0.25em;
	*/
	margin-top: -2em;
	margin-bottom: 1em;
	color: #848;
	font-size: 0.5em;
	font-weight: bold;
	font-style: italic;
	text-decoration: italic;
	text-align: center;
	display: block;
}

span#song:hover
{
	color: #A6A;
}
		</style>
	</head>
	<body>
		<div id="container">
			<h1>TouhouStrove 7: Perfect Ostrove Blossom.</h1>
			<span id="song">Left Click to Toggle Music, Right Click to Change
				Song!</span>
			<canvas id="bullet_canvas"></canvas>
			<canvas id="info_canvas"></canvas>
		</div>
		<script src="math.js" type="text/javascript"></script>
		<script src="pob.js"  type="text/javascript"></script>
		<script type="text/javascript">
var songdir = "./bgm";
var songs   = [
	"[01] Youyoumu ~ Snow or Cherry Petal [3467c3fd].mp3",
	"[02] Mukau no Kyou ~ Deep Mountain [de966d15].mp3",
	"[03] Crystallize Silver [b840b93d].mp3",
	"[04] Toono Gensou Monogatari [6782f4d4].mp3",
	"[05] Diao ye zong (withered leaf) [c154ec08].mp3",
	"[06] Bucuresti no Ningyoushi [b5202f6b].mp3",
	"[07] Ningyou Saiban ~ Hito no Katachi Moteasobishi Shoujo [ac0bae7e].mp3",
	"[08] Tenkuu no Hana no Miyako [f3386e19].mp3",
	"[09] Yuurei Gakudan ~ Phantom Ensemble [d9e22204].mp3",
	"[10] Touhou Youyoumu ~ Ancient Temple [c059e896].mp3",
	"[11] Hiroari Kechou o Iru Koto ~ Till When [58672392].mp3",
	"[12] Ultimate Truth [6dad8e6e].mp3",
	"[13] Yuuga ni Sakase, Sumizome no Sakura ~ Border of Life [7c92b65e].mp3",
	"[14] Border of Life [c625c31a].mp3",
	"[15] Youyou Bakko [b440506e].mp3",
	"[16] Shoujo Gensou ~ Necro-Fantasy [f0e63d57].mp3",
	"[17] Youyou Bakko ~ Who done it! [dee47b38].mp3",
	"[18] Necrofantasia [c7f4b8e5].mp3",
	"[19] Shunpuu no Yume [c4d863c6].mp3",
	"[20] Sakura Sakura ~ Japanize Dream... [743408f5].mp3",
];
var song_names = [
	"Mystic Dream &#x301C; Snow or Cherry Petal",
	"Paradise &#x301C; Deep Mountain",
	"Crystallized Silver",
	"The Fantastic Legend of Tohno",
	"Withered Leaf",
	"The Doll Maker of Bucuresti",
	"Doll Judgment &#x301C; The Girl who Played with People's Shapes",
	"The Capital City of Flowers in the Sky",
	"Ghostly Band &#x301C; Phantom Ensemble",
	"Mystic Oriental Dream &#x301C; Ancient Temple",
	"Hiroari Shoots a Strange Bird &#x301C; Till When?",
	"Ultimate Truth",
	"Bloom Nobly, Cherry Blossoms of Sumizome &#x301C; Border of Life",
	"Border of Life",
	"Charming Domination",
	"A Maiden's Illusionary Funeral &#x301C; Necro-Fantasy",
	"Charming Domination &#x301C; Who done it?",
	"Necrofantasia",
	"Dream of a Spring Breeze",
	"Sakura, Sakura &#x301C; Japanize Dream...",
];
var audios = [];

var song_info = document.getElementById("song");

var cur_song = Math.floor(Math.random() * songs.length);
for (var i = 0; i < songs.length; i++) {
	var a = new Audio(songdir + "/" + songs[i]);
	a.load();
	a.id = i;
	a.onended = function(){
		next_song();
	};
	audios[i] = a;
}

function next_song(inc)
{
	var inc = inc || false;

	if (!inc) {
		cur_song++;
	}

	if (cur_song >= songs.length) {
		cur_song = 0;
	}

	song_info.innerHTML = song_names[cur_song];
	audios[cur_song].play();
}

var playing = false;
function toggle()
{
	var a   = audios[cur_song];
	var p   = playing;
	playing = !playing;
	if (p) {
		a.pause();
	} else {
		next_song(true);
	}
	return false;
}

function toggle_next()
{
	var a = audios[cur_song];
	a.pause();
	a.currentTime = 0;

	playing = true;
	next_song();

	return false;
}

song_info.onclick       = toggle;
song_info.oncontextmenu = toggle_next;

/*
var container_change = false;
var container = document.getElementById("container");
setInterval(function() {
	container.classList.toggle("change");
}, 2000);
*/
		</script>
	</body>
</html>
